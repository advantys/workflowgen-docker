steps:
  - task: Docker@1
    inputs:
      command: login
      containerregistrytype: Container Registry
      dockerRegistryEndpoint: Charles Docker Hub
  - task: PowerShell@2
    inputs:
      targetType: filePath
      filePath: scripts/build-images.ps1
  - powershell: |
      docker container ls -aq | ForEach-Object { docker container rm -f $_ 2> $null }
      docker image ls -f 'dangling=true' -q `
        '| ForEach-Object { docker image rm -f $_ 2> $null }'
    condition: succeededOrFailed()

